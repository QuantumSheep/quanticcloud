<!DOCTYPE html>
<html lang="en" ng-app="quanticCloud">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>Quantic Cloud</title>

    <link rel="icon" href="/assets/favicon.ico">

    <link rel="stylesheet" href="/assets/css/grid.css">
    <link rel="stylesheet" href="/assets/css/modal.css">
    <link rel="stylesheet" href="/assets/css/style.css">

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="/assets/js/explorer.js"></script>

    <script type="text/ng-template" id="filetree">
        <li ng-repeat="item in items" ng-init="filei = filei; $parent.filei = $parent.filei + 1;">
            <span ng-if="item.type != 'directory'" class="tree_label">{{ item.name }}</span>
            <input ng-if="item.type == 'directory'" ng-init="filei = filei + 1; $parent.filei = $parent.filei + 1;" type="checkbox" id="c-{{ filei }}">
            <label ng-if="item.type == 'directory'" for="c-{{ filei }}" class="tree_label">{{ item.name }}</label>
            <ul ng-if="item.type == 'directory' && item.childs" ng-init="items = item.childs;" ng-include="'filetree'"></ul>
        </li>
    </script>
</head>

<body ng-controller="Explorer">
    <div class="modal micromodal-slide" id="modal-newfile" aria-hidden="true">
        <div class="modal__overlay" tabindex="-1" data-micromodal-close>
            <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-newfile-title">
                <div class="modal__header">
                    <h2 class="modal__title" id="modal-newfile-title">
                        Micromodal
                    </h2>
                    <button class="modal__close" aria-label="Close modal" data-micromodal-close></button>
                </div>
                <div class="modal__content" id="modal-newfile-content">
                    <p>
                        Try hitting the
                        <code>tab</code> key and notice how the focus stays within the modal itself. Also,
                        <code>esc</code> to close modal.
                    </p>
                </div>
                <div class="modal__footer">
                    <button class="modal__btn modal__btn-primary">Continue</button>
                    <button class="modal__btn" data-micromodal-close aria-label="Close this dialog window">Close</button>
                </div>
            </div>
        </div>
    </div>
    <header>
        <nav>
            <ul>
                <li>
                    <a href="/">Quantic Cloud</a>
                </li>
            </ul>
            <ul>
                <li>
                    <a href="/explorer">My files</a>
                </li>
                <li>
                    <a href="/">Disconnect</a>
                </li>
            </ul>
        </nav>
    </header>
    <main>
        <aside>
            <ul class="tree">
                <li ng-repeat="file in tree">
                    <input type="checkbox" id="c{{ filei }}" />
                    <label for="c{{ filei }}" class="tree_label">{{ file.name }}</label>
                    <ul ng-init="items = file.childs; filei = $index;" ng-include="'filetree'"></ul>
                </li>
            </ul>
        </aside>
        <section id="explorer">
            <div class="rmenu hide" id="rmenu">
                <ul>
                    <li>
                        <a href="#!" id="newfolder">New folder</a>
                    </li>
                    <li>
                        <a href="#!" id="newfile">New file</a>
                    </li>
                    <li>
                        <a href="#!">Sort by</a>
                    </li>
                </ul>
            </div>
            <div class="d-flex flex-column">
                <div ng-if="!filedata.error">
                    {{ filedata.data }}
                </div>
                <ul ng-if="files.length > 0" class="filelist">
                    <li ng-repeat="file in files" class="col-lg-1 col-md-2 col-sm-3 col-xs-3">
                        <a href="{{ currentlocation }}/{{ file.name }}" ng-click="explore($event.target.parentElement.pathname, true, $event);">
                            <img src="/assets/img/{{file.ext != null ? 'fileicons/' + file.ext : 'folder'}}.svg">
                            <span>{{file.name}}</span>
                        </a>
                    </li>
                </ul>
            </div>
        </section>
    </main>

    <script src="https://unpkg.com/micromodal/dist/micromodal.min.js"></script>
</body>

</html>